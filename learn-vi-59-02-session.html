<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="zh" xml:lang="zh">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" type="text/css" href="learn-vi.css" />
	<title>VIM学习笔记 会话(Session)</title>
</head>
<body>
	<h1>VIM学习笔记 会话(Session)</h1>
	<p>会话信息，将保存所有编辑窗口和全局设置。通过恢复会话，可以快速切换回之前工作环境。可以认为，会话是<a href="http://yyq123.github.io/learn-vim/learn-vi-59-01-viminfo.html" title="vimifo">viminfo</a>的扩展补充，viminfo文件中保存了会话所需要使用的具体设置信息。</p>
	<p>如下图所示，我在编辑本文档的同时，打开了帮助文件和命令终端。首先，将当前编辑状态保存到会话文件；稍后，只需要恢复会话，就可以继续使用之前的窗口布局进行编辑了，而省去了手动打开多个窗口的繁琐。</p>
	<p><a href="https://yyq123.github.io/learn-vim/images/session.png" title="session"><img src="https://yyq123.github.io/learn-vim/images/session.png" alt="Session" width="430" height="311" /></a></p>

	<h2 class="article"><a id="session_save">保存会话</a></h2>
	<p>使用以下命令，将保存会话信息至当前目录下，以&ldquo;Session.vim&rdquo;命名的文件：</p>
	<p style="text-indent:2em"><code class="inset">:mksession</code></p>
	<p>如果已经存在同名的会话文件，那么需要在命令中使用&ldquo;&excl;&rdquo;参数，进行强制覆盖：</p>
	<p style="text-indent:2em"><code class="inset">:mks!</code></p>
	<p>也可以在命令中，指定会话信息文件的位置：</p>
	<p style="text-indent:2em"><code class="inset">:mksession ~/mysession.vim </code></p>

	<h2 class="article"><a id="session_restore">恢复会话</a></h2>
	<p>在<a href="http://yyq123.github.io/learn-vim/learn-vi-209-Start.html" title="">启动</a>Vim时，通过指定&ldquo;-S&rdquo;参数，可以恢复之前保存的编辑会话：</p>
	<p style="text-indent:2em"><code class="inset">$ vim -S Session.vim</code></p>
	<p>在Vim中使用以下命令，也可以恢复会话信息：</p>
	<p style="text-indent:2em"><code class="inset">:source Session.vim</code></p>

	<p>使用以下命令，可以查看关于会话信息的帮助文件：</p>
	<p style="text-indent:2em"><code class="inset">:help session</code></p>


	<h2 class="article"><a id="session_options">会话选项</a></h2>
	<p>会话选项sessionoptions，用于指定保存会话的内容，默认值如下：</p>
	<p style="text-indent:2em"><code class="inset">:set sessionoptions=blank,buffers,curdir,folds,help,options,tabpages,winsize,terminal</code></p>
	<p>sessionoptions选项是一组使用逗号分隔的字符串，包含以下参数：</p>
	<ul>
		<li><p style="padding:5px; margin:0; border-left:1px solid;"><em>blank</em><br />恢复编辑无名缓冲区的<a href="http://yyq123.github.io/learn-vim/learn-vi-14-MultiWindows.html" title="Window">窗口</a>；</p></li>
		<li><p style="padding:5px; margin:0; border-left:1px solid;"><em>buffers</em><br />恢复所有<a href="http://yyq123.github.io/learn-vim/learn-vi-13-MultiBuffers.html" title="Buffer">缓冲区</a>（包括隐藏和未载入的缓冲区）；</p></li>
		<li><p style="padding:5px; margin:0; border-left:1px solid;"><em>curdir</em><br />恢复当前目录；</p></li>
		<li><p style="padding:5px; margin:0; border-left:1px solid;"><em>folds</em><br />恢复<a href="http://yyq123.github.io/learn-vim/learn-vi-63-Fold.html" title="Fold">折叠</a>；</p></li>
		<li><p style="padding:5px; margin:0; border-left:1px solid;"><em>globals</em><br />恢复以大写字母开始并至少包含一个小写字母的全局变量；</p></li>
		<li><p style="padding:5px; margin:0; border-left:1px solid;"><em>help</em><br />恢复帮助窗口；</p></li>
		<li><p style="padding:5px; margin:0; border-left:1px solid;"><em>localoptions</em><br />恢复（限定于缓冲区内）本地选项；</p></li>
		<li><p style="padding:5px; margin:0; border-left:1px solid;"><em>options</em><br />恢复全局映射和选项；</p></li>
		<li><p style="padding:5px; margin:0; border-left:1px solid;"><em>resize</em><br />恢复以行列指定的窗口大小；</p></li>
		<li><p style="padding:5px; margin:0; border-left:1px solid;"><em>sesdir</em><br />设置当前目录为会话文件所在的位置；</p></li>
		<li><p style="padding:5px; margin:0; border-left:1px solid;"><em>salsh</em><br />在文件名中使用salsh（&sol;），来代替backslah（&bsol;）；</p></li>
		<li><p style="padding:5px; margin:0; border-left:1px solid;"><em>tabpages</em><br />恢复所有<a href="http://yyq123.github.io/learn-vim/learn-vi-15-Tabs.html" title="Tabs">标签页</a>；</p></li>
		<li><p style="padding:5px; margin:0; border-left:1px solid;"><em>terminal</em><br />恢复终端窗口；</p></li>
		<li><p style="padding:5px; margin:0; border-left:1px solid;"><em>unix</em><br />使用Unix模式的行尾标志（&lt;NL&gt;）；</p></li>
		<li><p style="padding:5px; margin:0; border-left:1px solid;"><em>winpos</em><br />恢复 GUI Vim 的窗口位置；</p></li>
		<li><p style="padding:5px; margin:0; border-left:1px solid;"><em>winsize</em><br />恢复窗口尺寸（相对于屏幕大小）；</p></li>
	</ul>
	<p>使用以下命令，可以查看关于会话选项的帮助信息：</p>
	<p style="text-indent:2em"><code class="inset">:help 'sessionoptions'</code></p>

	<table summary="Commands" border="2" frame="hsides" rules="all" cellspacing="0" cellpadding="3">
		<caption>命令小结</caption>
		<tr><td><code class="inset">:mksession</code></td><td>保存会话</td></tr>
		<tr><td><code class="inset">:source Session.vim</code></td><td>恢复会话</td></tr>
		<tr><td><code class="inset">:set sessionoptions</code></td><td>设置会话选项</td></tr>
	</table>

	<p style="border-top:1px solid lightgray"><span style="float:right">Ver: 2.0&nbsp;|&nbsp;<a href="mailto:yyq123@gmail.com">YYQ</a></span><span>&lt;<a title="vimrc" href="http://yyq123.github.io/learn-vim/learn-vi-59-vimrc.html">上一篇</a>&nbsp;|<a title="笔记列表" href="http://yyq123.github.com/learn-vim/learn-vi-00-00-TOC.html">&nbsp;目录&nbsp;</a>|&nbsp;<a title="set-option" href="http://yyq123.github.io/learn-vim/learn-vi-50-SetOption.html">下一篇</a>&gt;</span></p>

</body>
</html>
