<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="zh" xml:lang="zh">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" type="text/css" href="learn-vi.css" />
	<title>VIM学习笔记 自动完成(Auto-Complete)</title>
</head>
<body>
	<h1>VIM学习笔记 自动完成(Auto-Complete)</h1>
	<h2 class="article"><a id=""></a></h2>
	<p></p>
	<a href="#" title=""></a>
	<p><a href="https://yyq123.github.io/learn-vim/images/.png" title=""><img src="https://yyq123.github.io/learn-vim/images/.png" alt="" width="550" height="" /></a></p>

	<p>在<a href="http://yyq123.github.io/learn-vim/learn-vi-42-InsertMode.html" title="插入模式(Insert Mode)">插入模式</a>下，利用自动完成（Insertion-Completion）功能，vim能够根据正在输入的字符，查找可能匹配的文本并显示在弹出列表中；使用<kbd>Ctrl-N</kbd>键向下或<kbd>Ctrl-P</kbd>键向上选择匹配的条目；最后点击<kbd>Enter</kbd>回车键将选中的匹配项放置到光标处。</p>
	<p>如果您想放弃自动完成操作，那么请点击<kbd>Ctrl-E</kbd>键以退回插入模式并继续输入。请注意，在匹配列表中点击<kbd>Esc</kbd>将会选中当前条目。</p>

	<h2 class="article"><a id="complete-wholeline">整行匹配（Whole line completion）</a></h2>
	<p>使用<kbd>Ctrl-X&nbsp;Ctrl-L</kbd>快捷键，将在<a href="#complete-opt" title="complete-opt">'complet'</a>选项定义的范围（例如当前文件）中查找匹配的行。例如输入&ldquo;&lt;h&rdquo;，然后调用整行匹配，将会显示所有以&ldquo;h&rdquo;开头的HTML标签。</p>
	<p><a href="https://yyq123.github.io/learn-vim/images/AutoCompletion_WholeLine.png" title="AutoCompletion_WholeLine"><img src="https://yyq123.github.io/learn-vim/images/AutoCompletion_WholeLine.png" alt="" width="550" height="92" /></a></p>
	
	<h2 class="article"><a id="complete-keywordinfile">关键词匹配（Keyword local completion）</a></h2>
	<p>使用<kbd>Ctrl-X&nbsp;Ctrl-N</kbd>快捷键，将在<a href="#complete-opt" title="complete-opt">'complet'</a>选项定义的范围（例如当前文件）中查找匹配的关键词（keyword）。</p>
	<p>此处的关键词，是指由<a href="https://yyq123.github.io/learn-vim/learn-vi-09-word.html" title="iskeyword">'iskeyword'</a>选项定义的字符串。默认情况下，iskeyword=@,48-57,_,192-255，认为由数字、字母和下划线组成的字符串为关键词。而句点和短横线，则被是为关键词之间的分隔符。您可以通过设置'iskeyword'选项，来改变关键词的定义。</p>

	<p></p>
	<p>vim能够根据正在输入的字符，查找文件中已经存在的单词，按<kbd>ctrl+n</kbd>，就会自动补全单词剩余的部分。</p>
	<p>例如，我们想要输入以下句子：</p>
	<p style="text-indent:2em;font-style:italic">I have beautiful flowers in my flower garde</p>
	<p>由于文件中还没有类似单词可供参考，所以我们需要手工输入以下内容:</p>
	<p style="text-indent:2em;font-style:italic">I have beautiful flowers in my f</p>
	<p>此时文件中已经存在了单词&ldquo;flower&rdquo;，因此我们只要按下<kbd>Ctrl-n</kbd>快捷键就可以自动完成单词录入了。</p>
	<p>在默认情况下，Vim是按照以下步骤来查找匹配文本：</p>
	<ol>
		<li>在当前文件中进行查找</li>
		<li>在其他窗口中进行查找</li>
		<li>在其他已装入的缓冲区中进行查找</li>
		<li>在没有装入缓冲区的文件中进行查找</li>
		<li>在当前的标记(tag)列表是进行查找</li>
		<li>在所有的由当前文件的#include包含进来的文件中进行查找</li>
	</ol>
	<p>我们在使用自动完成功能时，<kbd>ctrl+P</kbd>是向后查找匹配的单词,而<kbd>ctrl+N</kbd>是向前查找匹配的单词。</p>

	<h2 class="article"><a id="complete-dictionary">字典匹配（Dictionary completion）</a></h2>
	<p>使用<kbd>Ctrl-X&nbsp;Ctrl-K</kbd>快捷键，将在'dictionary'选项定义的文件中查找匹配的关键词。</p>
	<p>默认情况下'dictionary'选项为空。可以使用<code class="inset">:set dictionary</code>命令，指定字典文件。</p>
	<p>对于Linux系统，通常会查找/usr/dict/words或/usr/share/dict/words目录下的字典文件：</p>
	<p style="text-indent:2em"><code class="inset">:set dictionary=/usr/dict/words,/usr/share/dict/words</code></p>
	<p>你也可以包括自定义的字典文件：</p>
	<p style="text-indent:2em"><code class="inset">:set dictionary+=home/oualline/words</code></p>
	<p>对于Windows系统，如果已经安装了<a href="http://yyq123.github.io/learn-vim/learn-vi-804-Toolkit-CLI-Win.html#Cygwin" title="Windows命令行环境(Toolkit-CLI-Win)">Cygwin</a>，那么可以选择添加<a href="https://cygwin.com/packages/summary/words.html" title="words">words</a>软件包；然后根据您的Cygwin安装目录，来指定字典文件：</p>
	<p style="text-indent:2em"><code class="inset">set dictionary=D:\cygwin64\usr\share\dict\linux.words</code></p>
	<p><a href="https://yyq123.github.io/learn-vim/images/Tools_Cygwin_SelectPackages_dict.png" title="Tools_Cygwin_SelectPackages_dict"><img src="https://yyq123.github.io/learn-vim/images/Tools_Cygwin_SelectPackages_dict.png" alt="Tools_Cygwin_SelectPackages_dict" width="550" height="140" /></a></p>
	<p>假设我们需要输入单词&ldquo;acknowledged&rdquo;，只需要首先输入&ldquo;ack&rdquo;三个字母，然后点击快捷键即可进行匹配：</p>
	<p><a href="https://yyq123.github.io/learn-vim/images/AutoCompletion_Dictionary.png" title="AutoCompletion_Dictionary"><img src="https://yyq123.github.io/learn-vim/images/AutoCompletion_Dictionary.png" alt="AutoCompletion_Dictionary" width="550" height="197" /></a></p>
	<code class="inset"></code>命令。<code class="inset"></code>来设置。我们也可以指定一个字典文件和k选项组合使用<code class="inset">:set dictionary=k/usr/oualline/words</code>。也可以多次的使用k这个标记选项<code class="inset">:set dictionary=k/usr/dict/words,k/usr/share/words</code></p>

	<h2 class="article"><a id="complete-thesaurus">词典匹配（Thesaurus completion）</a></h2>
	<p>使用<kbd>Ctrl-X&nbsp;Ctrl-T</kbd>快捷键，将在'thesaurus'选项定义的文件中查找匹配的关键词。</p>
	<p>默认情况下'thesaurus'选项为空。可以使用<code class="inset">:set thesaurus</code>命令，指定字典文件。</p>
	<p>首先，<a href="https://github.com/vim/vim/issues/629#issuecomment-443293282" title="Thesaurus Zip">下载</a>词典文件；然后，解压缩后将其中的thesaurus.txt文件复制为~/.vim/thesaurus/english.txt,；最后使用以下命令，来指定词典文件：</p>
	<p style="text-indent:2em"><code class="inset">:set thesaurus=$HOME\vimfiles\thesaurus\english.txt</code></p>
	<p>假设我们输入单词&ldquo;enjoy&rdquo;，然后点击<kbd>Ctrl-X&nbsp;Ctrl-T</kbd>快捷键，将会在词典文件中查找光标下的单词：</p>
	<p><a href="https://yyq123.github.io/learn-vim/images/AutoCompletion_Thesaurus.png" title="AutoCompletion_Thesaurus"><img src="https://yyq123.github.io/learn-vim/images/AutoCompletion_Thesaurus.png" alt="AutoCompletion_Thesaurus" width="550" height="137" /></a></p>
	<p>因为在词典文件中，每行会包含多个单词，所以将显示匹配行中的所有单词：</p>
	<p style="text-indent:2em"><code class="msg">bask enjoy relish savor savour lie</code></p>

	<h2 class="article"><a id="complete-dictionary">包含匹配（Path pattern completion）</a></h2>
	<p>使用<kbd>Ctrl-X&nbsp;Ctrl-I</kbd>快捷键，将在当前文件以及由#include包含进来的文件中查找匹配的关键词。</p>

	<h2 class="article"><a id="complete-tag">标签匹配（Tag completion）</a></h2>
	<p>使用<kbd>Ctrl-X&nbsp;Ctrl-]</kbd>快捷键，将在当前文件以及由#include包含进来的文件中查找匹配的标签。</p>

	<h2 class="article"><a id="complete-filename">文件名匹配（File name completion）</a></h2>
	<p>使用<kbd>Ctrl-X&nbsp;Ctrl-F</kbd>快捷键，可以匹配并补全文件名。如果当前光标下的文本不包含任何路径信息，那么将显示当前目录下的文件列表；如果当前光标下的文本包含任何（绝对或相对）路径信息，那么将显示其指定目录下的文件列表；如果当前光标下的文本包含唯一的路径信息（比如&ldquo;~&rdquo;），那么将自动转换为目录的完整名称。</p>
	<p><a href="https://yyq123.github.io/learn-vim/images/AutoCompletion_FileName.png" title="AutoCompletion_FileName"><img src="https://yyq123.github.io/learn-vim/images/AutoCompletion_FileName.png" alt="AutoCompletion_FileName" /></a></p>

	<h2 class="article" id="ctrl-x-mode">^X模式</h2>
	<p>在插入模式下，输入<kbd>ctrl-X</kbd>将进入完成模式（^X mode），屏幕底部将显示以下提示信息：</p>
	<p style="text-indent:2em"><code class="msg">-- ^X mode (^]^D^E^F^I^K^L^N^O^Ps^U^V^Y)</code></p>
	<p>您可以继续进行以下自动完成操作:</p>
	<table border="0" cellspacing="3" cellpadding="3" style="margin-left:2em">
		<tr><td>CTRL-]</td><td>标记(tags)</td></tr>
		<tr><td>CTRL-D</td><td>宏定义</td></tr>
		<tr><td>CTRL-E</td><td>向上滚动文本</td></tr>
		<tr><td>CTRL-F</td><td>文件名</td></tr>
		<tr><td>CTRL-I</td><td>当前文件以及由#include包含进来的文件</td></tr>
		<tr><td>CTRL-K</td><td>字典</td></tr>
		<tr><td>CTRL-L</td><td>整行</td></tr>
		<tr><td>CTRL-N</td><td>向后查找,与没有CTRL-X命令时相同</td></tr>
		<tr><td>CTRL-P</td><td>向前查找,与没有CTRL-X命令时相同</td></tr>
		<tr><td></td><td></td></tr>
		<tr><td>CTRL-Y</td><td>向下滚动文本</td></tr>

	</table>
	<p>例如编辑main.c文件时，按下<kbd>ctrl-X</kbd>进入CTRL-X的子模式。如果我们要查找一个宏定义，就可以按下<kbd>CTRL-D</kbd>，这时屏幕底部就会显示出有多少匹配的选项，然后用CTRL-P和CTRL-N选择想要的条目。而<kbd>CTRL-]</kbd>则是查找下一个标记(tag)，即C函数的定义。</p>


	<h2 class="article" id="complete-opt">自动完成选项</h2>
	<p>通过设置'complete'选项，可以定义自动完成的范围和方式：</p>
	<p style="text-indent:2em"><code class="inset">:set complete=key,key,key</code></p>
	<p>命令中可能出现的key值如下：</p>
	<table summary="complete" border="1" frame="border" rules="all" cellspacing="0" cellpadding="3">
		<tr><td style="font-weight:bold">.</td><td>当前缓冲区</td></tr>
		<tr><td style="font-weight:bold">b</td><td>缓冲区列表中的其它已载入的缓冲区</td></tr>
		<tr><td style="font-weight:bold">d</td><td>在当前的文件中定义和由#include包含进来的文件</td></tr>
		<tr><td style="font-weight:bold">i</td><td>由#include包含进来的文件</td></tr>
		<tr><td style="font-weight:bold">k</td><td>由dictionary选项指定的文件</td></tr>
		<tr><td style="font-weight:bold">kspell</td><td>当前激活的拼写检查</td></tr>
		<tr><td style="font-weight:bold">k{dict}</td><td>名为{dict}的文件</td></tr>
		<tr><td style="font-weight:bold"></td><td></td></tr>
		<tr><td style="font-weight:bold">s</td><td>由thesaurus选项指定的文件</td></tr>
		<tr><td style="font-weight:bold">t</td><td>标记(tags)文件</td></tr>
		<tr><td style="font-weight:bold">u</td><td>缓冲区列表中的没有载入的缓冲区</td></tr>
		<tr><td style="font-weight:bold">w</td><td>在其他窗口中载入的文件</td></tr>
	</table>
	<p>自动完成'complete'选项的默认值为：</p>
	<p style="text-indent:2em"><code class="inset">:set complete=.,w,b,u,t,i</code></p>
	<p>例如使用以下命令，将字典文件添加到搜索列表中：</p>
	<p style="text-indent:2em"><code class="inset">:set complete+=k</code></p>
	<p>通过设置'completeopt'选项，可以控制匹配列表的显示方式。根据以下默认设置，将在popup menu中显示匹配列表，并显示匹配来源文件的额外信息。</p>
	<p style="text-indent:2em"><code class="inset">:set completeopt=menu,preview</code></p>
<p></p>

	<h2 class="article" id="complete-ignorecase">忽略大小写</h2>
	<p>如果我们使用以下命令，设置了在查找过程中忽略大小写，那么在自动完成时，反而会造成区分大小写：</p>
	<p style="text-indent:2em"><code class="inset">:set ignorecase</code></p>
	<p>使用以下命令，则可以设置在自动完成时忽略大小写：</p>
	<p style="text-indent:2em"><code class="inset">:set infercase</code></p>


	<table summary="Commands" border="2" frame="hsides" rules="all" cellspacing="0" cellpadding="3">
		<caption>命令小结</caption>
		<tr><td><code class="inset">:</code></td><td rowspan="2"></td></tr>
		<tr><td><code class="inset">:</code></td></tr>
		<tr><td><code class="inset">:</code></td><td></td></tr>
		<tr><td><code class="inset">:</code></td><td></td></tr>
		<tr><td><code class="inset">:</code></td><td></td></tr>
	</table>
&ldquo;&rdquo;
	<p style="border-top:1px solid lightgray"><span style="float:right">Ver: 2.0&nbsp;|&nbsp;<a href="mailto:yyq123@gmail.com">YYQ</a></span><span>&lt;<a title="" href="http://yyq123.github.io/learn-vim/.html">上一篇</a>&nbsp;|<a title="笔记列表" href="http://yyq123.github.com/learn-vim/learn-vi-00-00-TOC.html">&nbsp;目录&nbsp;</a>|&nbsp;<a title="" href="http://yyq123.github.io/learn-vim/.html">下一篇</a>&gt;</span></p>

</body>
</html>
