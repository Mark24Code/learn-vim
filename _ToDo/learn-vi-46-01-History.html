<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="zh" xml:lang="zh">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" type="text/css" href="learn-vi.css" />
	<title>VIM学习笔记 命令行模式 (History)</title>
</head>
<body>
	:help :
	<p style="font-weight:bold; border-bottom:1px solid lightgray; border-left:6px solid lightgray; padding:0 0 3px 5px"></p>
	<p></p>
	<p style="font-weight:bold; border-bottom:1px solid lightgray; border-left:6px solid lightgray; padding:0 0 3px 5px">进入命令行模式</p>
	<p>输入<code class="inset">:</code>命令；使用<code class="inset">/</code>或<code class="inset">?</code>搜索命令，都将进入命令行模式（Command-line mode）。用户可以在屏幕底部的命令行中输入命令，或者使用以下快捷键遍历之前的命令历史，然后点击<kbd>&lt;Enter&gt;</kbd>键来执行命令。</p>
	<table summary="Commands" border="2" frame="hsides" rules="all" cellspacing="0" cellpadding="3">
		<tr><td><kbd>&uarr;</kbd></td><td rowspan="2">显示上一条命令</td></tr>
		<tr><td><kbd>Ctrl + p</kbd></td></tr>
		<tr><td><kbd>&darr;</kbd></td><td rowspan="2">显示下一条命令</td></tr>
		<tr><td><kbd>Ctrl + n</kbd></td></tr>
		<tr><td><kbd>Ctrl + b</kbd></td><td>移动到命令行开头</td></tr>
		<tr><td><kbd>Ctrl + e</kbd></td><td>移动到命令行末尾</td></tr>
		<tr><td><kbd>Ctrl + &larr;</kbd></td><td rowspan="2">向左移动一个单词</td></tr>
		<tr><td><kbd>Shift + &larr;</kbd></td></tr>
		<tr><td><kbd>Ctrl + &rarr;</kbd></td><td rowspan="2">向右移动一个单词</td></tr>
		<tr><td><kbd>Shift + &rarr;</kbd></td></tr>
		<tr><td><kbd>Ctrl + w</kbd></td><td>删除光标前的一个单词</td></tr>
		<tr><td><kbd>Ctrl + u</kbd></td><td>删除光标前的所有字符</td></tr>
	</table>

	<p>输入部分命令，比如输入<code class="inset">:set</code>，然再点击上下光标键，将自动对命令历史纪录进行过滤，仅仅显示以&ldquo;set&rdquo;开头的命令历史纪录。</p>
	<p></p>
	<p>继续键入命令<code class="inset">:set i</code>之后，按下<kbd>Tab</kbd>或<kbd>Ctrl+D</kbd>键，就将显示匹配以i开头的set命令；继续按<kbd>Tab</kbd>键，可以在这些命令列表间移动，按下回车键就可以执行该命令。持的所有</p>
	<p><a href="https://yyq123.github.io/learn-vim/images/set_i_tab.png" title="set_i_tab"><img src="https://yyq123.github.io/learn-vim/images/set_i_tab.png" alt="set_i_tab" width="500" height="78" /></a></p>
	<p><code class="inset">:help cmdline-editing</code></p>
	<p>进入命令行模式之后，点击<kbd>Ctrl+r</kbd><kbd>Ctrl+w</kbd>键可以将当前光标下的<a href="https://yyq123.github.io/learn-vim/learn-vi-09-word.html" title="word">word</a>粘贴到命令行中；点击<kbd>Ctrl+r</kbd><kbd>Ctrl+a</kbd>键可以将当前光标下的<a href="https://yyq123.github.io/learn-vim/learn-vi-09-word.html" title="word">WORD</a>粘贴到命令行；点击<kbd>Ctrl+r</kbd><kbd>%</kbd>键可以将当前文件名粘贴到命令行。</p>
	<p><code class="inset">:help c_CTRL-R_CTRL-W</code></p>
	<p style="font-weight:bold; border-bottom:1px solid lightgray; border-left:6px solid lightgray; padding:0 0 3px 5px">命令行窗口</p>
	<p>可以使用以下四种方式，来打开命令行窗口（command line window）：</p>
	<ol>
		<li>在命令行模式下，使用<kbd>CTRL-F</kbd>快捷键打开命令行窗口，并显示命令历史纪录；</li>
		<li>在常规模式下，使用<code class="inset">q:</code>命令打开命令行窗口，并显示命令历史纪录；<br /><a href="https://yyq123.github.io/learn-vim/images/command-line-window-cmd.png" title="command-line-window"><img src="https://yyq123.github.io/learn-vim/images/command-line-window-cmd.png" alt="command-line-window" /></a></li>
		<li>在常规模式下，使用<code class="inset">q/</code>命令打开命令行窗口，并显示向前查找（search forward）的历史纪录；<br /><a href="https://yyq123.github.io/learn-vim/images/command-line-window-sf.png" title="command-line-window"><img src="https://yyq123.github.io/learn-vim/images/command-line-window-sf.png" alt="command-line-window" /></a></li>
		<li>在常规模式下，使用<code class="inset">q?</code>命令打开命令行窗口，并显示向后查找（search backward）的历史纪录；<br /><a href="https://yyq123.github.io/learn-vim/images/command-line-window-sb.png" title="command-line-window"><img src="https://yyq123.github.io/learn-vim/images/command-line-window-sb.png" alt="command-line-window" /></a></li>
	</ol>
	From Command-line mode, use the key specified with the 'cedit' option.
   The default is CTRL-F when 'compatible' is not set.
	<p>我们可以将命令行窗口，视为常规的<a href="http://yyq123.github.io/learn-vim/learn-vi-13-MultiBuffers.html" title="Buffer">缓冲区 (Buffer)</a>来编辑。可以在其中查找命令历史纪录，并在此基础上进行修改，然后点击<kbd>&lt;Enter&gt;</kbd>键来执行命令（命令行窗口也将同时关闭）。</p>
	<p></p>
	<p>使用一下命令，可以设置命令行窗口的高度（默认值为7）：</p>
	<p style="text-indent:2em"><code class="inset">set cmdwinheight=n</code></p>
	<p>使用<code class="inset">:q</code>命令，可以关闭命令行窗口。</p>
	<p>使用<code class="inset">:help command-line-window</code>命令，可以查看命令行窗口的更多帮助信息。</p>

<p style="font-weight:bold; border-bottom:1px solid lightgray; border-left:6px solid lightgray; padding:0 0 3px 5px">命令历史</p>
	<p style="text-indent:2em"><code class="inset">:history</code></p>
	help :history
命令:history可以显示当前命令模式下的命令历史
Vim编辑器可以记录各种命令的历史,下面的标记指出所记录的历史类型;
c    cmd    :    命令行历史
s    search    /    查找字符串历史
e    expr    =    表达式寄存器历史 expression register history
i    input    @    输入行历史 data typed in response to an :input operator
a    all        所有的历史
如果我们列出所有的历史,我们可以用下面的命令:
	<p style="text-indent:2em"><code class="inset">:history all</code></p>

:history命令的一般格式如下:
:history code first,last
<p>如果没有指定first和last，那么就会列出所有的命令历史。first参数默认是指命令历史的第一条；last是指最后一条；而负数则是相对于最后一条历史纪录的向前位移。</p>
<p>例如下面的命令列出第一个到第五个的命令行历史:</p>
	<p style="text-indent:2em"><code class="inset">:history c 1,5</code></p>

而下面的命令则是列出了上五次的查找历史:
	<p style="text-indent:2em"><code class="inset">:history s -5</code></p>
	<p>通过history选项，可以控制记录历史命令的数量。例如使用以下命令，设置保存1000条命令历史纪录：</p>
:set history=1000

<p>命令历史是存储在viminfo文件中的; you can configure what (and how many of them) is persisted via the 'viminfo' (and 'history') options.
	<p><a href="https://yyq123.github.io/learn-vim/images/viminfo.png" title="viminfo"><img src="https://yyq123.github.io/learn-vim/images/viminfo.png" alt="viminfo" width="500" height="332" /></a></p>

You can clear the history via the histdel() function, e.g. for searches:

:call histdel('')

You can even delete just certain history ranges or matching lines.

Alternatively, you could also just edit the ~/.viminfo file directly (when Vim is closed, and either with another editor, or with vim -i NONE).


Vim编辑器可以记录上几次的错误以及在屏幕最后一行显示的信息.要查看这些信息,我们可以用下面的命令:
	<p style="text-indent:2em"><code class="inset">:messages</code></p>

下面的命令可以使得信息的输出在显示在屏幕的同时会拷贝到一个文件中:
:redir &gt; file
如果要停止拷贝,可以使用下面的命令:
:redir END
这个命令在保存调试信息时会显得更为有用.
我们还可以用:redir命令将输出追加到文件中:
:redir &gt;&gt; file
	
	<table summary="Commands" border="2" frame="hsides" rules="all" cellspacing="0" cellpadding="3">
		<caption>命令小结</caption>
		<tr><td><code class="inset">:</code></td><td rowspan="2"></td></tr>
		<tr><td><code class="inset">:</code></td></tr>
		<tr><td><code class="inset">:</code></td><td></td></tr>
		<tr><td><code class="inset">:</code></td><td></td></tr>
		<tr><td><code class="inset">:</code></td><td></td></tr>
	</table>

</body>
</html>

