<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="zh" xml:lang="zh">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" type="text/css" href="learn-vi.css" />
	<title>VIM学习笔记 Ex模式 (Ex Commands)</title>
</head>
<body>
	<h1>VIM学习笔记 Ex模式 (Ex Commands)</h1>
	<p>使用以冒号&ldquo;:&rdquo;开头的Ex命令，可以非常高效地处理多行的大段文字。</p>
	<p>例如使用以下Ex进行文本编辑：</p>
	<table summary="Commands" border="2" frame="hsides" rules="all" cellspacing="0" cellpadding="3">
		<tr><th>命令</th><th>缩写</th><th>用途</th></tr>
		<tr><td><code class="inset">delete</code></td><td><code class="inset">d</code></td><td>删除行</td></tr>
		<tr><td><code class="inset">move</code></td><td><code class="inset">m</code></td><td>移动行</td></tr>
		<tr><td><code class="inset">copy</code></td><td><code class="inset">co</code></td><td>复制行</td></tr>
		<tr><td><code class="inset"></code></td><td><code class="inset">t</code></td><td>复制行，与co同义</td></tr>
	</table>

	<p></p>
	<p style="text-indent:2em"><code class="inset"></code></p>
	<p><a href="https://yyq123.github.io/learn-vim/images/ExMode.png" title="ExMode"><img src="https://yyq123.github.io/learn-vim/images/ExMode.png" alt="ExMode" /></a></p>

	<p style="font-weight:bold; border-bottom:1px solid lightgray; border-left:6px solid lightgray; padding:0 0 3px 5px">Ex命令的寻址模式</p>
	<p>在Ex命令中，可以使用以下三种方式，来指定命令所影响的行或行范围：</p>
	<ul>
		<li>使用行号，指定绝对地址；</li>
		<li>使用特殊符号，指定相对地址；</li>
		<li>由搜索模式，指定匹配地址。</li>
	</ul>
	<p style="font-weight:bold">指定行号的绝对地址</p>
	<p>使用以下命令，可以打印当前文件的第二行内容（到屏幕）：</p>
	<p style="text-indent:2em"><code class="inset">:2p</code></p>
	<p>通过在命令中指定行号范围，可以显示多行内容：</p>
	<p style="text-indent:2em"><code class="inset">:2,10p</code></p>
	<p>使用以下命令，可以将11至15行移动到23行下面：</p>
	<p style="text-indent:2em"><code class="inset">:11,15m23</code></p>
	<p>使用以下命令，可以复制23至29行并粘贴到100行下面：</p>
	<p style="text-indent:2em"><code class="inset">:23,29co100</code></p>

	<p style="font-weight:bold">特殊符合指定的相对地址</p>
	<p>在指定行地址时，可以使用特殊符号：点&ldquo;<code class="inset">.</code>&rdquo;代表当前行；美元符号&ldquo;<code class="inset">$</code>&rdquo;代表文件的最后一行；百分号&ldquo;<code class="inset">%</code>&rdquo;代表文件的每一行，等同于1,$的组合。特殊符号可以与行号组合使用，例如：</p>
	<p>使用以下命令，可以删除最后一行：</p>
	<p style="text-indent:2em"><code class="inset">:$d</code></p>
	<p>使用以下命令，可以删除从当前行到文件末尾：</p>
	<p style="text-indent:2em"><code class="inset">:.,$d</code></p>
	<p>使用以下命令，可以删除文件中的所有行：</p>
	<p style="text-indent:2em"><code class="inset">:1,$d</code></p>
	<p style="text-indent:2em"><code class="inset">:%d</code></p>
	<p>使用以下命令，可以把20至当前行的文本移动到文件末尾：</p>
	<p style="text-indent:2em"><code class="inset">:20,.m$</code></p>
	<p>使用以下命令，可以复制所有行并粘贴到文件的尾部：</p>
	<p style="text-indent:2em"><code class="inset">:%t$</code></p>
	<p>当符号&ldquo;<code class="inset">+</code>&rdquo;和&ldquo;<code class="inset">-</code>&rdquo;放置在数字前面时，就会像数学运算符一样，表示加上或减去指定的行数。例如：</p>
	<p>使用以下命令，可以删除当前行之前的所有行：</p>
	<p style="text-indent:2em"><code class="inset">:1,.-1d</code></p>
	<p>使用以下命令，可以删除从当前行到当前行以下20行：</p>
	<p style="text-indent:2em"><code class="inset">:.,.+20d</code></p>
	<p>使用以下命令，可以把226行到文件末尾的文本移动到当前行的上面两行的后面：</p>
	<p style="text-indent:2em"><code class="inset">:226,$m.-2</code></p>
	<p>事实上，由于当前行是假定的开始位置，因此在使用+或-时并不必需输入圆点符号；如果在+或-后面没有数字，那么就等价于+1和-1；数字0代表文件的开头（即0行）。</p>
	<p>使用以下命令，可以复制三行（当前行，前一行，后一行），并粘贴到文件开头：</p>
	<p style="text-indent:2em"><code class="inset">:-,+t0</code></p>

	<p style="font-weight:bold">搜索模式指定的匹配地址</p>
	<p>使用以下命令，可以删除下一个包含模式pattern的行：</p>
	<p style="text-indent:2em"><code class="inset">:/pattern/d</code></p>
	<p>使用以下命令，可以删除下一个包含模式pattern的行的下一行：</p>
	<p style="text-indent:2em"><code class="inset">:/pattern/+d</code></p>
	<p>使用以下命令，可以删除第一个包含pattern1的行与第一个包含pattern2的行之间的所有行：</p>
	<p style="text-indent:2em"><code class="inset">:/pattern1/,/pattern2/d</code></p>
	<p>使用以下命令，可以从当前行到第一个包含pattern的行之间的文本移动到23行后面：</p>
	<p style="text-indent:2em"><code class="inset">:.,/pattern/m23</code></p>

	<p style="font-weight:bold">重新定义当前行的位置</p>
	<p>假设当前光标在第一行。</p>
	<p style="text-indent:2em"><code class="inset">:100,+5p</code></p>
	<p>执行以上命令，系统将反馈信息认为终止行位置小于起始行位置：</p>
	<p style="text-indent:2em"><code class="msg">Backwards range given, OK to swap (y/n)</code></p>
	<p>如果输入y，则意味着交换行范围的起止位置，即显示（1+5=）6至100行；如果输入n，则行范围（100至6行）无效，命令失败。</p>
	<p>如果我们希望将第一个行地址视为“当前行”，那么可以在ex命令中使用分号&ldquo;;&rdquo;代替逗号&ldquo;,&rdquo;。</p>
	<p>不管当前光标处于文件的哪一行，以下命令都将视第100行为当前行，并显示当前行及之后5行（即100至105行）：</p>
	<p style="text-indent:2em"><code class="inset">:100;+5p</code></p>
	<p>分号也可以用于搜索模式的相对地址中。例如，显示下一个包含模式pattern的行以及之后的10行：</p>
	<p style="text-indent:2em"><code class="inset">:/patter/;+10p</code></p>


	<p><a href="https://yyq123.github.io/learn-vim/images/.png" title=""><img src="https://yyq123.github.io/learn-vim/images/.png" alt="" width="500" height="" /></a></p>

全局搜索

ex也有全局命令g， 可以让你搜索模式并显示找出的所有包含该模式的行。命令：g!的作用与：g相反，使用：g!（或它的同义词：v）可以搜索不包行该模式的行

可以对文件中的所有行使用全局命令，也可以使用行地址把全局搜索限定在指定的行或行范围内。

	<p>寻找并显示文件中所有包含模式pattern的行</p>
	<p style="text-indent:2em"><code class="inset">:g /pattern/p</code></p>
	<p>寻找并显示文件中所有不包行模式pattern的行，并显示这些行号</p>
	<p style="text-indent:2em"><code class="inset">:g!/pattern/nu</code></p>
	<p></p>
	<p style="text-indent:2em"><code class="inset"></code></p>

	<p>删除包含模式pattern的行：</p>
	<p style="text-indent:2em"><code class="inset">:g /pattern/d</code></p>
	<p>删除不包含模式pattern的行：</p>
	<p style="text-indent:2em"><code class="inset">:g!/pattern/d</code></p>
	<p>删除所有空行：</p>
	<p style="text-indent:2em"><code class="inset">:g /^$/d</code></p>
	<p>寻找并显示第20到40行之间所有包含模式pattern的行</p>
	<p style="text-indent:2em"><code class="inset">:20,40g/pattern/p</code></p>


	<p style="font-weight:bold; border-bottom:1px solid lightgray; border-left:6px solid lightgray; padding:0 0 3px 5px">组合Ex命令</p>
	<p>竖直线&ldquo;|&rdquo;作为命令分割符，可以将多个命令组合在一起执行。使用&ldquo;|&rdquo;时，如果前一个命令影响到文件中行的顺序，那么下一个命令将使用新的行位置进行工作。</p>
	<p>使用以下命令，将首先删除第1行至第3行，然后在当前行（即调用ex命令之前的第4行）进行替换：</p>
	<p style="text-indent:2em"><code class="inset">:1,3d | s/thier/their/</code></p>
	<p>使用以下命令，将首先把1至5行移动到第10行之后，然后显示所有包含模式pattern的行：</p>
	<p style="text-indent:2em"><code class="inset">:1,5m10 | g/pattern/nu</code></p>

	<p style="font-weight:bold; border-bottom:1px solid lightgray; border-left:6px solid lightgray; padding:0 0 3px 5px">退出Ex模式</p>
	<p></p>
	<p style="text-indent:2em"><code class="inset"></code></p>
	<p></p>
	<p style="text-indent:2em"><code class="inset"></code></p>



	<table summary="Commands" border="2" frame="hsides" rules="all" cellspacing="0" cellpadding="3">
		<caption>命令小结</caption>
		<tr><td><code class="inset">:</code></td><td rowspan="2"></td></tr>
		<tr><td><code class="inset">:</code></td></tr>
		<tr><td><code class="inset">:</code></td><td></td></tr>
		<tr><td><code class="inset">:</code></td><td></td></tr>
		<tr><td><code class="inset">:</code></td><td></td></tr>
	</table>


	<p style="border-top:1px solid lightgray"><span style="float:right">Ver: 2.0&nbsp;|&nbsp;<a href="mailto:yyq123@gmail.com">YYQ</a></span><span>&lt;<a title="" href="http://yyq123.github.io/learn-vim/.html">上一篇</a>&nbsp;|<a title="笔记列表" href="http://yyq123.github.com/learn-vim/learn-vi-00-00-TOC.html">&nbsp;目录&nbsp;</a>|&nbsp;<a title="" href="http://yyq123.github.io/learn-vim/.html">下一篇</a>&gt;</span></p>

</body>
</html>
