<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="zh" xml:lang="zh">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" type="text/css" href="learn-vi.css" />
	<title>VIM学习笔记 正则表达式（Regular Expression）</title>
</head>
<body>
	<p>Vim使用正则表达式(regular expressions)来进行逻辑查找。正则达式是神秘和简洁的，然而这种强大的功能也必须要以大量的学习才能够习惯和掌握。</p>
	<p>一个正则表达式是由一些元素组成的，一个元素可以是一个字符或者是一个特殊字符。</p>
	<p style="font-weight:bold; border-bottom:1px solid lightgray; border-left:6px solid lightgray; padding:0 0 3px 5px">启用/禁用</p>
	<p>在通用表达式中，我们用<strong>&lt;</strong>来匹配一个单词的开始，用<strong>&gt;</strong>来匹配一个单词的结束。也就是说，将我们想要查找的字符串放在这两个中间，就可以更精确的查找字符串。例如在文件中有Californian和Unfortunately。如果用命令<code class="inset">/for</code>来查找，那么就会找到这两个单词。而如果用通用表达式<code class="inset">/\&lt;for\&gt;</code>来进行查找，则只会精确的查找到for，而不会出现其他的匹配情况。</p>
	<p>星号（<strong>*</strong>）通配符，作用于其之前的一个元素，表示可以匹配0次或是多次。所以通用表达式<code class="inset">te*</code>可以匹配te,tee,teee等等。甚至还可以匹配t，因为在这里e可以匹配0次。如果需要匹配一个字符串，那么必须使用"\("和"\)"进行限定。例如，命令<code class="inset">/\(ab\)*</code>，将可以匹配 "ab", "abab", "ababab", 和""等等。</p>
	<p>加号（<strong>+</strong>）通配符，表示一个字符可以匹配一次或是多次。所以表达式te+可以匹配te,tee,teee等等。但是不可以再匹配t了,因为这里e最少要匹配一次。</p>
	<p>等号（<strong>=</strong>）通配符，表示一个字符匹配0次或是一次。所以表达te=可以匹配t,te，但是不可以匹配tee，因为这个表达式只能匹配不多于两个字符。</p>
	<p>还有一些特殊的字符：如a匹配一个字符,而d匹配任何数字。所以表达式aaa可以匹配任意三个字符。而dddd则可以查找任意四个数字。而/aaa_则查找任意后带一个下划线的三个字符</p>

a可以匹配所有的字符(小写的或是大写的).
	<p style="font-weight:bold; border-bottom:1px solid lightgray; border-left:6px solid lightgray; padding:0 0 3px 5px">范围</p>
	<p>方括号（<strong>[]</strong>）通配符，表示只可以匹配方括号内列表的字符。例如<code class="inset">t[aeiou]n</code>只匹配一个小写元音字符，可以找到tan,ten,tin,ton,tun。</p>
	<p>在方括号内，可以通过短横线来指明包括字符或数字的范围。例如<code class="inset">[0-9]</code>可以匹配0到9中的任一数字。我们还可以组合其他的字符。例如<code class="inset">[0-9aeiou]</code>可以匹配任意一个数字或是小写的元音字符。</p>
To match the "-" character itself make it the first or last one in the
range.  These special characters are accepted to make it easier to use them
inside a [] range (they can actually be used anywhere in the search
pattern):

	\e	<Esc>
	\t	<Tab>
	\r	<CR>
	\b	<BS>

	<p style="font-weight:bold; border-bottom:1px solid lightgray; border-left:6px solid lightgray; padding:0 0 3px 5px">排除</p>
	<p>脱字符（<strong>^</strong>）通配符，可以排除指定的字符。</p>
	<p><code class="inset">acme[^0-9]</code>匹配所有包含acme，后跟一个非数字字符的行。但不会匹配以acme结尾的行，因为模式中的acme之后必须有一个字符。</p>
	<p><code class="inset">^[^a-zA-Z]</code>匹配以非字母开头的行，但不会匹配空行，因为行中必须有一个非字母字符存在。</p>


	<p style="font-weight:bold; border-bottom:1px solid lightgray; border-left:6px solid lightgray; padding:0 0 3px 5px">匹配次数</p>
	<p><strong>{minimum,maximum}</strong>表达式指出一个字符重复的次数。例如表达式<code class="inset">a{3,5}</code>可以匹配3到5个a。在表达式中，最小次数是可以省略的，即默认最小次数为0，所以表达式<code class="inset">a{,5}</code>可以匹配0到5个a。最大次数也是可以省略的，即默认匹配无穷大，所以表达式<code class="inset">a{3,}</code>最少可以匹配3个a，最多个数没有限制。</p>
	<p><strong>{number}</strong>表达式只指定一个数字，Vim就会精确的匹配相应的次数。例如<code class="inset">a{5}</code>只会精确的匹配5次。</p>
	<p><strong>{-minimum,maximum}</strong>在数字前增加一个负号(-)，那么Vim在查找时就会尽可能少的进行匹配（Matching as little as possible）。例如<code class="inset">ab\{-1,3}</code>将只匹配 "abbb"中的"ab"。表达式<code class="inset">a{-3,}</code>匹配三个或是更多个a，但尽可能少地的进行匹配。而表达式<code class="inset">a{-,5}</code>可以匹配0到5个字符。表达式<code class="inset">a{-}</code>可以匹配0到无穷多个字符，在通常情况下这个表达式匹配0个符，除非在它的后面还有字符或是表达式。例如<code class="inset">[a-z]{-}x</code>将会匹配.cxcx中的cx。而表达式<code class="inset">[a-z]*x</code>将会匹配整个cxcx。表达式<code class="inset">a{-5}</code>将会精确的匹配5个字符。</p>
	<p><a data-flickr-embed="true"  href="https://www.flickr.com/photos/yyq123/31042807084/in/dateposted/" title="RegularExpression_Matching as little as possible"><img src="https://c1.staticflickr.com/1/709/31042807084_415a4b4996_o.png" width="58" height="71" alt="RegularExpression_Matching as little as possible"></a></p>
	<p style="font-weight:bold; border-bottom:1px solid lightgray; border-left:6px solid lightgray; padding:0 0 3px 5px">或操作</p>
	<p>或运算运符（<strong>|</strong>）用于查找两个或是多个可能的匹配。例如表达式<code class="inset">foo|bar</code>可以找到foo或是bar。我们可以连接使用多个或运算符，例如表达式<code class="inset">Larry\|Moe\|Curly</code>将找到Larry、Moe和Curly。而表达式<code class="inset">/end\(if\|while\|for\)</code>则可以匹配"endif", "endwhile" 和 "endfor"几个不同的元素组合。</p>
	<p>如果希望匹配多次，那么可以组合使用加号和括号运算符。例如以下表达式可以匹配 "foo", "foobar", "foofoo", "barfoobar"等等。</p>
	<p style="text-indent:2em"><code class="inset">/\(foo\|bar\)\+</code></p>

	<p style="font-weight:bold; border-bottom:1px solid lightgray; border-left:6px solid lightgray; padding:0 0 3px 5px">综合应用</p>
	<p>例如要查找的内容为1MGU103，这个字符串由1个数字，3个大写字符和3个数字组成。我可以有以下几种方法来表示：</p>
<ul>
	<li><code class="inset">[0-9][A-Z]{3}[0-9]{3}</code><br />先用[0-9]表示前面的一个数字，然后加入[A-Z]大写字符，因为有三个大写字符，所以加入精确匹配的数字{3}，最后再加入末尾的三个数字。</li>
	<li><code class="inset">du{3}d{3}</code><br />利用d指任何的数字，而u指任何的大写字符，这种方式的查找效率要比第一种方法快得多。</li>
</ul>
我们还可以用这样的表达示:duuuddd,这个也可以找到我们想要的内容.
最后我们还可以用字符类来写出我们的表达式:
[[:digit:]][[:upper:]]{3}[[:digit:]]{3}
这四种方法都可以很好的来完成我们的工作

<p>表达式<code class="inset"><.\{-}></code>，可以匹配以&lt;开头以&gt;结尾的所有HTML代码标签。</p>

	<p style="font-weight:bold; border-bottom:1px solid lightgray; border-left:6px solid lightgray; padding:0 0 3px 5px">偏移(Offset)</p>
一些常用的偏移(Offset)定义:
+[num]        光标置于第一个匹配字符下第num行的开始处.
-[num]        光标置于第一个匹配字符上第num行的开始处.
e        匹配字符串的结尾处.
e[num]
光标置于第一个匹配字符串的结尾处,然后移动num个字符,如果为正,向右移,为负,向左移.
b s        第一个匹配字符串的开始处.
b[num]
s[num]
光标置于第一个匹配字符串的开始处,然后移动num个字符,如果为正,向右移,为负,向左移.
常用的通用表达式如下:(认为magic选项打开)
<table summary="Commands" border="2" frame="hsides" rules="all" cellspacing="0" cellpadding="3">
	<caption>简单的元素:</caption>
	<tr><td><code class="inset">x</code></td><td>字符x</td></tr>
	<tr><td><code class="inset">^</code></td><td>一行的开始处</td></tr>
	<tr><td><code class="inset">$</code></td><td> 一行的结尾处</td></tr>
	<tr><td><code class="inset">.</code></td><td>单一的字符</td></tr>
	<tr><td><code class="inset">&lt;</code></td><td>查找字符串的开始标记</td></tr>
	<tr><td><code class="inset">&gt;</code></td><td>查找字符串的结束标记</td></tr>
</table>
<p>例如：<code class="inset">^acme</code>，将匹配以acme开始的行。注意：除非出现在模式的开头，否则音调符号^就不是一个代表行开头的通配符，而会代表其他的含义。<code class="inset">2^4</code>，将匹配包含"2^4"的所有行。如果要查找以“^”开头的行，则需要使用<code class="inset">^^</code>模式。其中第一个^是通配符用于指示一行的开头，而第二个^则是实际的音调符号。如果要指明前导^是一个实际的音调符号而不是表示一行开头的通配符，那么就需要在其前面加一个转义的反斜杠（\）组成<code class="inset">\^acme</code>模式。同理：<code class="inset">acme$</code>，将匹配以acme结尾的行。<code class="inset">^acme$</code>，将匹配只包含acme一个单词的行。而<code class="inset">^$</code>，则会匹配所有空行。</p>
<p><code class="inset">dog.bone</code>，将匹配dog-bone，dog bone，dog/bone，但不会匹配dogbone，因为dog和bone之间并没有分隔符。</p>
<p>要指示任何字符出现的次数，可以同时使用句点和星号（.*），例如<code class="inset">dog.*bone</code>将匹配以下字符串：</p>
<ul>
	<li><code class="inset">dogbone</code></li>
	<li><code class="inset">dog-bone</code></li>
	<li><code class="inset">doggy bone</code></li>
	<li><code class="inset">My dog has a bone</code></li>
</ul>
<p>但上面的模式不会匹配dog在一行而bone在另一行的情况。</p>
<table summary="Commands" border="2" frame="hsides" rules="all" cellspacing="0" cellpadding="3">
	<caption>范围运算符:</caption>
	<tr><td><code class="inset">[abc]</code></td><td>匹配a,b或是c</td></tr>
	<tr><td><code class="inset">[^abc]</code></td><td>匹配除abc以处的字符</td></tr>
	<tr><td><code class="inset">[a-z]</code></td><td>匹配从a到z的所有小写字符</td></tr>
	<tr><td><code class="inset">[a-zA-Z]</code></td><td>匹配所有大小写字符</td></tr>
	<tr><td><code class="inset"></code></td><td></td></tr>
	<tr><td><code class="inset"></code></td><td></td></tr>
	<tr><td><code class="inset"></code></td><td></td></tr>
	<tr><td><code class="inset"></code></td><td></td></tr>
	<tr><td><code class="inset"></code></td><td></td></tr>
	<tr><td><code class="inset"></code></td><td></td></tr>
	<tr><td><code class="inset"></code></td><td></td></tr>
	<tr><td><code class="inset"></code></td><td></td></tr>
	<tr><td><code class="inset"></code></td><td></td></tr>
</table>

	<p style="font-weight:bold; border-bottom:1px solid lightgray; border-left:6px solid lightgray; padding:0 0 3px 5px">预定义字符</p>
	<p>如果需要找出包含空格的空行，那么可以使用<code class="inset">^\s.*$</code>表达式；如果需要找到没有空格的空行，则可以使用<code class="inset">\S</code></p>
		
<p>The \d operator will match any digit in a search, while the \D operator will match any non-digit in a search. To match any uppercase character, use \u, while \l will match any lowercase character. Using \U will match any non-uppercase character, and \L will match any non-lowercase character.</p>
	<p>请注意，以上预定义字符是不能内嵌在[]中使用的。例如，表达式[\d\l]是错误的，应使用<code class="inset">\(\d\|\l\)</code>表达式匹配数字或小写字符。</p>
	<p style="font-weight:bold; border-bottom:1px solid lightgray; border-left:6px solid lightgray; padding:0 0 3px 5px">转义符</p>
	<p>如果需要查找某些特殊符号（比如美元符号），那么可以使用反斜杠backslash（\）进行转义。例如：表达式<code class="inset">\$</code>可以匹配美元符号（$），而表达式<code class="inset">\^</code>则可以匹配脱字符（^）。需要注意的是，Note that the backslash character is itself a special character, so you'd need to use two backslashes together.</p>

	<p style="font-weight:bold; border-bottom:1px solid lightgray; border-left:6px solid lightgray; padding:0 0 3px 5px">匹配换行</p>
	<p>如果你想要查找的内容之中包含换行符，那么可以使用"<strong>\n</strong>"通配符。执行以下命令，将匹配以"the"结尾的行，和以"word"开头的下一行：</p>
	<p style="text-indent:2em"><code class="inset">/the\nword</code></p>
	<p>如果希望同时匹配包含换行，以及不包含换行（但包含一个空格）的"the word"，那么可以使用"\_s"匹配空格或换行：</p>
	<p style="text-indent:2em"><code class="inset">/the\_sword</code></p>
	<p>如果还希望同时匹配包含多个空格以及换行的"the word"，那么可以使用以下命令：</p>
	<p style="text-indent:2em"><code class="inset">/the\_s\+word</code></p>
	<p>Similarly, "\a" matches an alphabetic character, and "\_a" matches an alphabetic character or a line break.  The other character classes and
ranges can be modified in the same way by inserting a "_".

Many other items can be made to match a line break by prepending "\_".  For
example: "\_." matches any character or a line break.

Note: "\_.*" matches everything until the end of the file.  Be careful with
this, it can make a search command very slow.

Another example is "\_[]", a character range that includes a line break:

<p style="text-indent:2em"><code class="inset">/"\_[^"]*"</code></p>

This finds a text in double quotes that may be split up in several lines.


如果我们要指找所有的大写字符又应如何来做呢?一个办法就是使用表达式[A-Z].还有一个办法就是我们可以使用预先定义的字符类.[:upper:]可以匹配大写字符.所以我们要指找大写字符也可以这样的来写:[[:upper:]].我们可以使用字符类来写出所有的字符:
[[:upper:][:lower:]].
在Vim中还有许多不同的字符类定义

[:alnum:]    匹配所有的字符和数字
[:alpha:]    匹配所有的字符
[:ascii:]    匹配所有的ASCII字符
[:backspace:]    匹配退格符<BS>
[:blank:]    匹配空格和Tab
[:cntrl:]    匹配所有的控制字符
[:digit:]    匹配所有的数字
[:escape:]    匹配Esc
[:graph:]    匹配所打印的字符,不包括空格
[:lower:]    匹配所有的小写字符
[:print:]    匹配所有的要打印字符,包括空格
[:return:]    匹配所有的行末符号(包括<Enter>,<CR>,<NL>).
[:punct:]    匹配所有的功能符号
[:space:]    匹配所有的空白符
[:tab:]        匹配Tab
[:upper:]    匹配所有的大写字符
[:xdigit:]    匹配十六进制数字.
类型:
(pattern)    标记一个类型以后使用
1        与第一个在()中的子表达式匹配的字符串匹配相同的字符串
例如表达式([a-z])1可以匹配aa,bb或是类似的.
2        与1相类似,但是是使用第二个子表达式
9        与1相类似,但是是使用第九个子表达式


修饰符:
*    匹配0次或是多次,尽可能多的匹配
+    匹配1次或是多次,尽可能多的匹配
=    匹配0次或是1次
{}    匹配0次或是多次
{n}
{-n}    匹配n次
{n,m}    匹配n次到m次
{n,}    匹配n次到多次
{,m}    匹配0次到m次
{-n,m}    匹配n次到m次,尽可能少的进行匹配
{-n,}    至少匹配n次,尽可能少的进行匹配
{-,m}    匹配到m次,尽可能少的进行匹配
{-}    匹配0次到多次,尽可能少的进行匹配
str1|str2    匹配str1或是str2

http://vimregex.com/
	<table summary="Commands" border="2" frame="hsides" rules="all" cellspacing="0" cellpadding="3">
		<caption>命令小结</caption>
		<tr><td colspan="2">字符类:</td></tr>



		<tr><td colspan="2">特殊字符:</td></tr>
		<tr><td><code class="inset">a</code></td><td>大小写字母字符 [a-zA-Z]</td></tr>
		<tr><td><code class="inset">A</code></td><td>除了a-zA-Z 以外的字母字符</td></tr>
		<tr><td><code class="inset">b</code></td><td>&lt;BS&gt;</td></tr>
		<tr><td><code class="inset">d</code></td><td>数字字符 [0-9]</td></tr>
		<tr><td><code class="inset">D</code></td><td>非数字字符 [^0-9]</td></tr>
		<tr><td><code class="inset">e</code></td><td>&lt;ESC&gt;</td></tr>
		<tr><td><code class="inset">f</code></td><td>由isfname选项定义的文件名字符</td></tr>
		<tr><td><code class="inset">F</code></td><td>文件名字符,但是不包含数字</td></tr>
		<tr><td><code class="inset">h</code></td><td>单词的头字符(A-Za-z)</td></tr>
		<tr><td><code class="inset">H</code></td><td>不是单词的头字符(A-Za-z)</td></tr>
		<tr><td><code class="inset">i</code></td><td>由isdent选项定义的字符</td></tr>
		<tr><td><code class="inset">I</code></td><td>定义的字符,但是不包括数字</td></tr>
		<tr><td><code class="inset">k</code></td>由iskeyword选项定义的关键字字符<td></td></tr>
		<tr><td><code class="inset">K</code></td><td>关键字字符,但是不包括数字</td></tr>
		<tr><td><code class="inset">l</code></td><td>小字字符 [a-z]</td></tr>
		<tr><td><code class="inset">L</code></td><td>非小写字符 [^a-z]</td></tr>
		<tr><td><code class="inset">o</code></td><td>八进制数字</td></tr>
		<tr><td><code class="inset">O</code></td><td>非八进制数字</td></tr>
		<tr><td><code class="inset">p</code></td><td>由isprint选项定义的可打印字符</td></tr>
		<tr><td><code class="inset">P</code></td><td>可打印字符,但是不包括数字</td></tr>
		<tr><td><code class="inset">r</code></td><td>&lt;CR&gt;</td></tr>
		<tr><td><code class="inset">s</code></td><td>空白符<Space>和<Tab> [ 	]</td></tr>
		<tr><td><code class="inset">S</code></td><td>非空白符 [^ 	]</td></tr>
		<tr><td><code class="inset">t</code></td><td>&lt;Tab&gt;</td></tr>
		<tr><td><code class="inset">u</code></td><td>大写字母字符 [A-Z]</td></tr>
		<tr><td><code class="inset">U</code></td><td>非大写字母字符 [^A-Z]</td></tr>
		<tr><td><code class="inset">w</code></td><td>单词字符(0-9A-Za-z)</td></tr>
		<tr><td><code class="inset">W</code></td><td>非单词字符</td></tr>
		<tr><td><code class="inset">x</code></td><td>十六进制数字 [0-9a-fA-F]</td></tr>
		<tr><td><code class="inset">X</code></td><td>非十六进制数字 [^0-9a-fA-F]</td></tr>
		<tr><td><code class="inset">~</code></td><td>匹配最后指定的字符串</td></tr>
		<tr><td><code class="inset"></code></td><td></td></tr>
		<tr><td><code class="inset"></code></td><td></td></tr>
		<tr><td><code class="inset"></code></td><td></td></tr>
		<tr><td><code class="inset"></code></td><td></td></tr>
		<tr><td><code class="inset"></code></td><td></td></tr>
		<tr><td><code class="inset"></code></td><td></td></tr>
		<tr><td><code class="inset"></code></td><td></td></tr>
		<tr><td><code class="inset"></code></td><td></td></tr>
		<tr><td><code class="inset"></code></td><td></td></tr>
	</table>
	<p style="border-top:1px solid lightgray"><span style="float:right">Ver: 1.0</span><span>&lt;<a title="()" href="">上一篇</a>&nbsp;|<a title="笔记列表" href="http://yyq123.github.com/learn-vim/learn-vi-00-List.html">&nbsp;目录&nbsp;</a>|&nbsp;<a title="()" href="">下一篇</a>&gt;</span></p>
</body>
</html>

